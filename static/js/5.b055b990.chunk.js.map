{"version":3,"sources":["assets/image/pencil-square.svg","pages/searchlog.js"],"names":["searchBYList","cityDestinationList","cityOriginList","exporterList","hsCode4DigitList","hsCodeList","importerList","portDestinationList","portOriginList","searchValue","relation","searchBy","queryBuilder","withRouter","connect","state","loading","loader","download_count","data","subscriptionId","dataAccess_count","totalWorkspace","subUserCount","queryPerDay","dispatch","loadingStart","loaderStart","loadingStop","loaderStop","updateSubscriptionCount","props","history","useHistory","userId","localStorage","getItem","userData","JSON","parse","searchList","setSearchList","useState","searchListData","setSearchListData","sortName","setSortName","undefined","sortOrder","setSortOrder","useEffect","getSearchList","userID","uplineId","Axios","method","url","then","res","tempQueryList","queryList","length","map","item","index","jsonData","Object","keys","key","Val","subKey","subVal","item2","index2","subitem","subindex","push","catch","err","console","log","options","onSortChange","_jsx","_Fragment","children","className","_jsxs","BootstrapTable","striped","hover","pagination","search","TableHeaderColumn","width","isKey","dataField","dataFormat","indexN","cell","row","enumObject","dataSort","QueryFormat","filter","elements","periodFormat","moment","fromDate","format","toDate","searchedByFormat","createdByEmail","searchedOnFormat","createdDate","actionFormatter","onClick","pathname","search_id","workspace_id"],"mappings":"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","file":"static/js/5.b055b990.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/pencil-square.75d078b5.svg\";","import React, { useEffect, useState } from 'react';\nimport Axios from \"../shared/Axios\";\nimport moment from 'moment';\nimport { useHistory } from 'react-router-dom';\nimport imagePencil from '../assets/image/pencil-square.svg';\nimport {BootstrapTable, TableHeaderColumn} from 'react-bootstrap-table';\nimport { loaderStart, loaderStop } from \"../store/actions/loader\";\nimport {updateSubscriptionCount} from \"../store/actions/data\"\nimport { connect } from \"react-redux\";\nimport { withRouter } from 'react-router-dom';\n\n// const searchBYList = { \"HS_CODE\": \"HS Code\", \"PRODUCT\": \"Product\", \"IMPORTER\": \"Importer\", \"EXPORTER\": \"Exporter\" };\n\nconst searchBYList = {\n  cityDestinationList : \"Destination City\",\n  cityOriginList : \"City of Origin\", \n  exporterList : \"Exporter List\", \n  hsCode4DigitList : \"HS Code (4 Digit)\", \n  hsCodeList : \"HS Code (8 Digit)\", \n  importerList : \"Importer List\", \n  portDestinationList : \"Destination Port\", \n  portOriginList : \"Port of Origin\", \n  searchValue : \"Search Value\",\n  relation : \"Relation\",\n  searchBy : \"Search By\",\n  queryBuilder : \"Additional\"\n\n  }\n\n\n const  Markets = (props) => {\n  const history = useHistory();\n\n  const userId = localStorage.getItem(\"userToken\");\n  let userData = localStorage.getItem(\"user\");\n  userData = userData ? JSON.parse(userData) : {};\n\n  const [searchList, setSearchList] = useState([]);\n  const [searchListData, setSearchListData] = useState([]);\n  const [sortName, setSortName] = useState(undefined);\n  const [sortOrder, setSortOrder] = useState(undefined);\n\n\n  const getSearchList = () => {\n\n    let userID = \"\"\n    userID = userData && userData.uplineId == 0 ? \"uplineId\" : \"userId\" ;\n    props.loadingStart()\n    Axios({\n      method: \"GET\",\n      url: `search-management/search/listAll?${userID}=${userId}`\n    })\n      .then(res => {\n        let tempQueryList = []\n        if(res.data.queryList && res.data.queryList.length > 0){      \n          res.data.queryList.map((item,index)=> {   \n            let jsonData = {} \n            Object.keys(item).map((key,Val)=>{    \n              if(key != \"userSearchQuery\"){\n                jsonData[key] = item[key] \n              }\n              else {\n                Object.keys(item[\"userSearchQuery\"]).map((subKey,subVal)=>{\n                  if(subKey != \"searchId\"){\n                    jsonData[subKey] = item[\"userSearchQuery\"][subKey]\n                    jsonData['querySting'] = searchBYList ? Object.keys(searchBYList).map((item2, index2) => (\n                      item2 == \"queryBuilder\" && item[\"userSearchQuery\"][item2] ? (\n                          item[\"userSearchQuery\"][item2].map((subitem, subindex) => (\n                            `<b>${searchBYList[item2]+(subindex+1)}</b>` +\" : \"+\n                            `<b>${searchBYList[\"relation\"]}</b>` +\" : \"+ subitem.relation + \" ,&nbsp \"+ `<b>${searchBYList[\"searchBy\"]}</b>` +\" : \"+ subitem.searchBy + \" ,&nbsp \"+ `<b>${searchBYList[\"searchValue\"]}</b>` +\" : \"+ subitem.searchValue\n                          ))\n                        ) : \n                        (item[\"userSearchQuery\"][item2] != \"\" && item[\"userSearchQuery\"][item2] != null ? `<b>&nbsp;${searchBYList[item2]}</b>` +\" : \"+ item[\"userSearchQuery\"][item2] : null)\n                      )) : null\n                  }\n                })\n              }\n            })\n            tempQueryList.push(jsonData)     \n          })\n        }\n        setSearchList(tempQueryList);\n        setSearchListData(tempQueryList);\n        props.loadingStop()\n      })\n      .catch(err => {\n        console.log(\"Err\", err);\n        props.loadingStop()\n      });\n  }\n\n  function onSortChange(sortName, sortOrder) {\n    setSortName(sortName);\n    setSortOrder(sortOrder);\n  }\n\n  useEffect(() => {\n    getSearchList();\n  }, []);\n\n  const searchTypeFormat = (cell,row) => {\n    return cell.searchType \n  }\n\n  const QueryFormat =(cell,row,enumObject, index) => {\n    \n      // let textString  =  searchBYList ? Object.keys(searchBYList).map((item, index) => (\n      //   item == \"queryBuilder\" && row[item] && row[item].length > 0 ? (\n      //     row[item].map((subitem, subindex) => (\n      //       `<b>${searchBYList[item]+(subindex+1)}</b>` +\" : \"+\n      //       `<b>${searchBYList[\"relation\"]}</b>` +\" : \"+ subitem.relation + \" , \"+ `<b>${searchBYList[\"searchBy\"]}</b>` +\" : \"+ subitem.searchBy + \" , \"+ `<b>${searchBYList[\"searchValue\"]}</b>` +\" : \"+ subitem.searchValue\n      //     ))\n      //   ) : \n      //   (row[item] != \"\" && row[item] != null ? `<b>${searchBYList[item]}</b>` +\" : \"+ row[item] : null)\n      // )) : null\n\n\n\n      let res = cell.filter(elements => {\n        return elements !== null;\n        });\n      return (res)\n  \n  }\n\n  const tradeTypeFormat = (cell,row) => {\n    return cell.tradeType \n  }\n\n  const countryFormat = (cell,row) => {\n    return cell.countryCode \n  }\n\n  const periodFormat = (cell, row) => {\n    return moment(row.fromDate).format(\"MMM. DD, YYYY\") + \" - \" + moment(row.toDate).format(\"MMM. DD, YYYY\");\n  }\n\n  const searchedOnFormat = (cell,row) => {\n    return moment(row.createdDate).format(\"MMM. DD, YYYY, h:mm:ss a\")\n  }\n\n  const searchedByFormat = (cell,row) => {\n    return cell + \" [ \" +row.createdByEmail+ \" ]\"\n  }\n\n\n  const actionFormatter = (cell,row) => {\n    return (<div> <button onClick={() => {\n      history.push({\n        pathname: '/list1',\n        state: {\n          search_id: cell, workspace_id: \"NIL\"\n        }\n      })\n    }} className=\"effect-btn btn btn-primary mt-2 mr-2 icon-lg\"><i className=\"icon ion-md-search\"></i></button>\n    </div>)\n  }\n\n  const options = {\n    sortName: sortName,\n    sortOrder: sortOrder,\n    onSortChange: onSortChange\n  };\n\n  const indexN = (cell,row,enumObject, index) => {\n    return  (<div>{index+1}</div>);\n  }\n\n  return (\n    <>\n      <div className=\"container-fluid\">\n\n        <div className=\"row\">\n          <div className=\"col-md-12 list-page mt-3\">\n    \n          <div className=\"row\">\n          <div className=\"col-lg-12 grid-margin stretch-card\">\n            <div className=\"card\">\n              <div className=\"card-body\">\n                <h4 className=\"card-title\">Search History</h4>\n                <div >\n                <BootstrapTable  data={searchList} striped hover \n                    pagination={ true } search\n                    options={ options }\n                >\n                    <TableHeaderColumn width='50' isKey dataField='id' dataFormat={ indexN }>Sl No</TableHeaderColumn>\n                    <TableHeaderColumn width='100' dataField='searchType'  dataSort={ true }>Search Type</TableHeaderColumn>\n                    <TableHeaderColumn width='520' dataField='querySting' dataFormat={ QueryFormat } dataSort={ true }>Query</TableHeaderColumn>\n                    <TableHeaderColumn width='100' dataField='tradeType' dataSort={ true }>Trade Type</TableHeaderColumn>\n                    <TableHeaderColumn width='80' dataField='countryCode'  dataSort={ true }>Country</TableHeaderColumn>\n                    <TableHeaderColumn width='150' dataField='userSearchQuery' dataFormat={ periodFormat } dataSort={ true }>Period</TableHeaderColumn>\n                    <TableHeaderColumn width='100' dataField='totalRecords'  dataSort={ true }>Total Records</TableHeaderColumn>\n                   { userData && userData.uplineId == 0 ?\n                    <TableHeaderColumn width='150' dataField='createdByName' dataFormat={ searchedByFormat } dataSort={ true }>Searched By</TableHeaderColumn> : null\n                   }\n                    <TableHeaderColumn width='160' dataField='userSearchQuery' dataFormat={ searchedOnFormat } dataSort={ true }>Searched On</TableHeaderColumn>\n                    <TableHeaderColumn width='50' dataField='searchId'  dataFormat={ actionFormatter }>Action</TableHeaderColumn>\n                </BootstrapTable>\n\n                </div>\n              </div>\n            </div>\n          </div>\n          </div>\n\n          </div>\n        </div>\n\n\n      </div>\n\n\n    </>\n  );\n}\n\nconst mapStateToProps = state => {\n  return {\n    loading: state.loader.loading,\n    download_count: state.data.download_count,\n    subscriptionId: state.data.subscriptionId,\n    dataAccess_count: state.data.dataAccess_count,\n    totalWorkspace: state.data.totalWorkspace,\n    subUserCount: state.data.subUserCount,\n    queryPerDay: state.data.queryPerDay,\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    loadingStart: () => dispatch(loaderStart()),\n    loadingStop: () => dispatch(loaderStop()),\n    updateSubscriptionCount: (data) => dispatch(updateSubscriptionCount(data)), \n  };\n};\nexport default withRouter (connect( mapStateToProps, mapDispatchToProps)(Markets));\n"],"sourceRoot":""}